<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Custom Chromecast Receiver</title>
  <script type="text/javascript" src="https://www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js"></script>
  <style>
    body, html {
      margin: 0; padding: 0; background: black; width: 100%; height: 100%;
    }
    video {
      width: 100%; height: 100%;
    }
    #ccOverlay {
      position: absolute; bottom: 10px; right: 10px; color: white;
      background: rgba(0,0,0,0.5); padding: 5px; font-family: sans-serif;
    }
  </style>
</head>
<body>
  <video id="video" controls></video>
  <div id="ccOverlay">Captions: ON</div>

  <script>
    const context = cast.framework.CastReceiverContext.getInstance();
    const playerManager = context.getPlayerManager();

    // Enable captions automatically
    playerManager.setMessageInterceptor(
      cast.framework.messages.MessageType.LOAD,
      loadRequestData => {
        const media = loadRequestData.media;

        // Enable tracks
        if (media.tracks) {
          media.tracks.forEach(track => {
            track.active = true; // force active
          });
        }

        // Ensure subtitles display by default
        if (media.textTrackStyle === undefined) {
          media.textTrackStyle = new cast.framework.messages.TextTrackStyle();
        }

        return loadRequestData;
      }
    );

    // Auto-start playback
    playerManager.setMessageInterceptor(
      cast.framework.messages.MessageType.PLAY,
      requestData => {
        console.log('PLAY requested');
        return requestData;
      }
    );

    context.start();
  </script>
</body>
</html>